library(readr)
citybike_train <- read_csv("Downloads/citybike.train.csv")
View(citybike_train)
citybike_test10000A <- read_csv("Downloads/citybike.test10000A.csv")
View(citybike_test10000A)
citybike_test10000B <- read_csv("Downloads/citybike.test10000B.csv")
View(citybike_test10000B)
citybike_train$age= as.double(2019-citybike_train$birth.year)
citybike_train$Day <- as.numeric(substr(citybike_train$starttime,9,10))
plot(citybike_train$bikeid,citybike_train$tripduration)
summary(citybike_train$tripduration)
summary(citybike_train$bikeid)
library(rpart)
install.packages("rpart.plot")
library(rpart.plot)
bikeid_rpart_model<- rpart(tripduration~Day+gender+age+bikeid, data=citybike_train,cp = 0.0006)
printcp(bikeid_rpart_model)
rpart.plot(bikeid_rpart_model)
citybike_test10000A$age= as.double(2019-citybike_test10000A$birth.year)
citybike_test10000A$Day <- as.numeric(substr(citybike_test10000A$starttime,9,10))
citybike_test10000B$age= as.double(2019-citybike_test10000B$birth.year)
citybike_test10000B$Day <- as.numeric(substr(citybike_test10000B$starttime,9,10))
citybike_test100$age= as.double(2019-citybike_test100$birth.year)
citybike_test100$Day <- as.numeric(substr(citybike_test100$starttime,9,10))
bikeid.rpart.predictions <-predict(bikeid_rpart_model,citybike_test100)
source("~/Downloads/Errors.R")
regr.error(bikeid.rpart.predictions,
           citybike_test100withduration$tripduration)
bikeid.rpart.predictionsFor10000A <-predict(bikeid_rpart_model,citybike_test10000A)
##mae          mse         rmse         mape 
##9.280814e+02 1.767658e+08 1.329533e+04 1.192186e+00

regr.error(bikeid.rpart.predictions,
           citybike_test10000Awithduration$tripduration)
bikeid.testB.rpart.predictions <-
  predict(bikeid_rpart_model,citybike_test10000B)
bikeidB.rpart.submission <- data.frame(1:10000,bikeid.testB.rpart.predictions)
colnames(bikeidB.rpart.submission)=c("Id","Predicted")
write.csv(bikeidB.rpart.submission,file="Downloads/bikeid.rpart.predictions.csv",row.names=FALSE)
